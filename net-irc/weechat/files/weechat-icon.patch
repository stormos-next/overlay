--- /var/tmp/portage/net-irc/weechat-0.4.0/work/weechat-0.4.0/CMakeLists.txt	2013-03-12 22:00:57.000000000 +0100
+++ /tmp/CMakeLists.txt	2013-03-12 21:40:44.000000000 +0100
@@ -132,6 +131,11 @@
 SET(includedir "\${prefix}/include")
 CONFIGURE_FILE(${CMAKE_CURRENT_SOURCE_DIR}/weechat.pc.in ${CMAKE_CURRENT_BINARY_DIR}/weechat.pc @ONLY)
 INSTALL(FILES ${CMAKE_CURRENT_BINARY_DIR}/weechat.pc DESTINATION ${LIBDIR}/../pkgconfig)
+# icon
+CONFIGURE_FILE(${CMAKE_CURRENT_SOURCE_DIR}/weechat_icon_32.png
+    ${CMAKE_CURRENT_BINARY_DIR}/weechat.png COPYONLY)
+INSTALL(FILES ${CMAKE_CURRENT_BINARY_DIR}/weechat.png DESTINATION
+    ${SHAREDIR}/icons/hicolor/32x32/apps)
 
 # packages
 SET(CPACK_PACKAGE_DESCRIPTION_SUMMARY "Fast, light and extensible chat client")
@@ -141,6 +145,7 @@
 SET(CPACK_PACKAGE_VERSION_MAJOR ${VERSION_MAJOR})
 SET(CPACK_PACKAGE_VERSION_MINOR ${VERSION_MINOR})
 SET(CPACK_PACKAGE_VERSION_PATCH ${VERSION_PATCH})
+SET(CPACK_BUNDLE_ICON "${CMAKE_CURRENT_SOURCE_DIR}/weechat_icon_32.png")
 
 # binary package
 SET(CPACK_GENERATOR "STGZ;TGZ;TBZ2")
